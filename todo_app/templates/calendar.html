<!DOCTYPE html>
<html>
<head>
    <title>Calendar</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="app-title"><h1>KNOW IT: TO DO APP</h1></div>

    <div class="page-container">
        <h2>üóìÔ∏è Calendar</h2>

        <!-- Month & Year Selector -->
        <div class="calendar-header">
            <h2>{{ current_month }} {{ current_year }}</h2>
            <form method="GET" action="/calendar" class="calendar-nav">
                <select name="month">
                    {% for m in range(1, 13) %}
                        <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
                    {% endfor %}
                </select>
                <select name="year">
                    {% for y in range(current_year - 5, current_year + 6) %}
                        <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
                    {% endfor %}
                </select>
                <button type="submit">Go</button>
            </form>
        </div>
        <!-- Day Names -->
        <div class="calendar-days">
            <div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
        </div>


        <!-- Calendar Grid -->
        <div class="calendar-grid">
            {% for _ in range(start_weekday) %}
                <div class="calendar-day empty"></div>
            {% endfor %}
            {% for day in calendar %}
                <div class="calendar-day {% if day.date == today_date %}today{% endif %}">
                    <span class="day-number">{{ day.day }}</span>
                    {% for task in day.tasks %}
                        <div class="calendar-task">
                            <span class="task-text">üìå {{ task.text }}</span>
                            <div class="task-actions">
                                <a href="/edit_event/{{ task.id }}" class="edit-btn">‚úèÔ∏è</a>
                                <a href="/delete_event/{{ task.id }}" class="delete-btn">üóëÔ∏è</a>
                            </div>
                        </div>

                    {% endfor %}
                    <button class="add-event-btn" onclick="openModal('{{ day.date }}')">‚ûï</button>
                </div>
            {% endfor %}
        </div>

        <a href="/" class="back-link">‚Üê Back to Dashboard</a>
    </div>

    <!-- Modal -->
    <div id="eventModal" class="modal">
        <form method="POST" action="/calendar" class="modal-content">
            <h3>Add Event</h3>
            <input type="hidden" name="date" id="eventDate">
            <input type="text" name="event" placeholder="Event Title" required>
            <button type="submit">Save</button>
            <button type="button" onclick="closeModal()">Cancel</button>
        </form>
    </div>

    <script>
        function openModal(date) {
            document.getElementById('eventDate').value = date;
            document.getElementById('eventModal').style.display = 'flex';
        }
        function closeModal() {
            document.getElementById('eventModal').style.display = 'none';
        }
    </script>
</body>
</html>
